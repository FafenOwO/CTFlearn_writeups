Category: Cryptography (367)
Difficulty: Hard
Points: 160

Scientists have launched the satellite with the most secured crypto-channel in the world!
It is quantum channel (BB84). But hackers had managed to sniff it.
You should help those hackers to find out what was in the satelliteâ€™s transmission. 
File: https://mega.nz/#!jfpChKTT!TTDfy2l1hGrNwDrM3DQEjX6kmUVDy5DmMatnka5NvXc

Let's call the sender person A and receiver person B. They use BB84, QKD.

We get 3 text files:
-transmission1.txt which contains qbits generated by person A
-transmission2.txt which contains bases generated by person B
-transmission3.txt which contains qbits person B got right, as bases are random it should be around 50%

The simpliest option possible is checking which qbits from person's A transmission person B got right and trying to decipher those. 
It technically shouldn't work as person A can't predict which parts person B will read right thus can't encode a message using them, but
this solution would make sense because those qbits are used to establish a safe encryption later on.

We don't know which of / and \ is 0 or 1 and same goes with - and |. However, there are only 4 options so we can check all.
The code could have been written in a clear and beautiful way, but why...
Code-gore I used is included in another file in this repo.
https://github.com/FafenOwO/CTFlearn_writeups/blob/Cryptography/The%20Most%20Secured%20Crypto-Channel.cpp
It basically just compares transmission 1 with transmission 3 and gives all 4 possible options.

4th output read as ASCII gives
b64:RmxhZ3tRdTRuN3VtQ3J5cDcwZ3I0cGh5SXM0RnU3dXIzfQ==
which is the flag in base 64:
Flag{Qu4n7umCryp70gr4phyIs4Fu7ur3}
